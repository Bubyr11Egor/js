<html>
<head>
<title>Friends</title>
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
<script src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-3.1.0.js" type="text/javascript"></script>
<script src="//code.jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script>

<script type="text/javascript">
    //person model
    function Person(data) {
    this.uid = ko.observable(data.uid);
    this.firstName = ko.observable(data.first_name);
    this.lastName = ko.observable(data.last_name);
    
    this.imgSrc = ko.observable(data.photo_50);
    this.fullName = ko.computed(function () {
        return this.firstName() + " " + this.lastName();
    }, this);
}

function FriendListViewModel(var allData) {
    
    var self = this;
    self.friends = ko.observableArray([]);
    
    $.getJSON("https://api.vk.com/method/friends.get?user_id=1406419&fields=nickname,sex,photo_50&callback=?", function(allData) {
	
    var mappedFriends = $.map(allData.response, function (item) {
        if (item.sex == 1) return new Person(item)
    });
    self.friends(mappedFriends);
    }); 
}


//update view with the data
ko.applyBindings(new FriendListViewModel());
</script>
</head>
<body>
<h3>Friends</h3>

<ul data-bind="foreach: friends, visible: friends().length > 0">
    <li>
        <img data-bind="attr:{src: imgSrc}" /><span data-bind="text: fullName"></span>

    </li>
</ul>You have <b data-bind="text: friends().length">&nbsp;</b> female friend(s)
<span data-bind="visible: friends().length == 0"> - no female friends</span>
</body>
</html>
